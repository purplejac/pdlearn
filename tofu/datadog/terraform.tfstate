{"version":4,"terraform_version":"1.8.5","serial":4,"lineage":"8d31d515-1407-b17d-671f-24e614130347","outputs":{},"resources":[{"mode":"data","type":"aws_iam_policy_document","name":"datadog_aws_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"1054084506","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"xray:GetTraceSummaries\",\n        \"xray:BatchGetTraces\",\n        \"wafv2:ListLoggingConfigurations\",\n        \"wafv2:GetRuleGroup\",\n        \"wafv2:GetRegexPatternSet\",\n        \"wafv2:GetLoggingConfiguration\",\n        \"wafv2:GetIPSet\",\n        \"waf:ListRules\",\n        \"waf:ListRuleGroups\",\n        \"waf-regional:ListRules\",\n        \"waf-regional:ListRuleGroups\",\n        \"timestream:DescribeEndpoints\",\n        \"tag:GetTagValues\",\n        \"tag:GetTagKeys\",\n        \"tag:GetResources\",\n        \"support:RefreshTrustedAdvisorCheck\",\n        \"support:DescribeTrustedAdvisor*\",\n        \"states:ListStateMachines\",\n        \"states:DescribeStateMachine\",\n        \"sqs:ListQueues\",\n        \"sns:Publish\",\n        \"sns:List*\",\n        \"sns:GetSubscriptionAttributes\",\n        \"ses:Get*\",\n        \"savingsplans:DescribeSavingsPlans\",\n        \"savingsplans:DescribeSavingsPlanRates\",\n        \"s3:PutBucketNotification\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:ListAccessGrants\",\n        \"s3:GetBucketTagging\",\n        \"s3:GetBucketNotification\",\n        \"s3:GetBucketLogging\",\n        \"s3:GetBucketLocation\",\n        \"route53:List*\",\n        \"redshift:DescribeLoggingStatus\",\n        \"redshift:DescribeClusters\",\n        \"rds:List*\",\n        \"rds:Describe*\",\n        \"organizations:List*\",\n        \"organizations:Describe*\",\n        \"oam:ListSinks\",\n        \"oam:ListAttachedLinks\",\n        \"logs:TestMetricFilter\",\n        \"logs:PutSubscriptionFilter\",\n        \"logs:FilterLogEvents\",\n        \"logs:DescribeSubscriptionFilters\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DeleteSubscriptionFilter\",\n        \"lightsail:GetInstancePortStates\",\n        \"lambda:List*\",\n        \"lambda:GetPolicy\",\n        \"kinesis:List*\",\n        \"kinesis:Describe*\",\n        \"health:DescribeEvents\",\n        \"health:DescribeEventDetails\",\n        \"health:DescribeAffectedEntities\",\n        \"glue:ListRegistries\",\n        \"glacier:GetVaultNotifications\",\n        \"fsx:ListTagsForResource\",\n        \"fsx:DescribeFileSystems\",\n        \"events:CreateEventBus\",\n        \"es:ListTags\",\n        \"es:ListDomainNames\",\n        \"es:DescribeElasticsearchDomains\",\n        \"elasticmapreduce:List*\",\n        \"elasticmapreduce:Describe*\",\n        \"elasticloadbalancing:Describe*\",\n        \"elasticfilesystem:DescribeTags\",\n        \"elasticfilesystem:DescribeFileSystems\",\n        \"elasticfilesystem:DescribeAccessPoints\",\n        \"elasticache:List*\",\n        \"elasticache:Describe*\",\n        \"ecs:List*\",\n        \"ecs:Describe*\",\n        \"ec2:SearchTransitGatewayRoutes\",\n        \"ec2:GetTransitGatewayPrefixListReferences\",\n        \"ec2:GetSnapshotBlockPublicAccessState\",\n        \"ec2:Describe*\",\n        \"dynamodb:List*\",\n        \"dynamodb:Describe*\",\n        \"directconnect:Describe*\",\n        \"cur:DescribeReportDefinitions\",\n        \"codedeploy:List*\",\n        \"codedeploy:BatchGet*\",\n        \"cloudwatch:List*\",\n        \"cloudwatch:Get*\",\n        \"cloudwatch:Describe*\",\n        \"cloudtrail:LookupEvents\",\n        \"cloudtrail:GetTrailStatus\",\n        \"cloudtrail:DescribeTrails\",\n        \"cloudfront:ListDistributions\",\n        \"cloudfront:GetDistributionConfig\",\n        \"cassandra:Select\",\n        \"budgets:ViewBudget\",\n        \"bcm-data-exports:ListExports\",\n        \"bcm-data-exports:GetExport\",\n        \"backup:ListRecoveryPointsByBackupVault\",\n        \"backup:List*\",\n        \"autoscaling:Describe*\",\n        \"apigateway:GET\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"xray:GetTraceSummaries\",\"xray:BatchGetTraces\",\"wafv2:ListLoggingConfigurations\",\"wafv2:GetRuleGroup\",\"wafv2:GetRegexPatternSet\",\"wafv2:GetLoggingConfiguration\",\"wafv2:GetIPSet\",\"waf:ListRules\",\"waf:ListRuleGroups\",\"waf-regional:ListRules\",\"waf-regional:ListRuleGroups\",\"timestream:DescribeEndpoints\",\"tag:GetTagValues\",\"tag:GetTagKeys\",\"tag:GetResources\",\"support:RefreshTrustedAdvisorCheck\",\"support:DescribeTrustedAdvisor*\",\"states:ListStateMachines\",\"states:DescribeStateMachine\",\"sqs:ListQueues\",\"sns:Publish\",\"sns:List*\",\"sns:GetSubscriptionAttributes\",\"ses:Get*\",\"savingsplans:DescribeSavingsPlans\",\"savingsplans:DescribeSavingsPlanRates\",\"s3:PutBucketNotification\",\"s3:ListAllMyBuckets\",\"s3:ListAccessGrants\",\"s3:GetBucketTagging\",\"s3:GetBucketNotification\",\"s3:GetBucketLogging\",\"s3:GetBucketLocation\",\"route53:List*\",\"redshift:DescribeLoggingStatus\",\"redshift:DescribeClusters\",\"rds:List*\",\"rds:Describe*\",\"organizations:List*\",\"organizations:Describe*\",\"oam:ListSinks\",\"oam:ListAttachedLinks\",\"logs:TestMetricFilter\",\"logs:PutSubscriptionFilter\",\"logs:FilterLogEvents\",\"logs:DescribeSubscriptionFilters\",\"logs:DescribeLogStreams\",\"logs:DescribeLogGroups\",\"logs:DeleteSubscriptionFilter\",\"lightsail:GetInstancePortStates\",\"lambda:List*\",\"lambda:GetPolicy\",\"kinesis:List*\",\"kinesis:Describe*\",\"health:DescribeEvents\",\"health:DescribeEventDetails\",\"health:DescribeAffectedEntities\",\"glue:ListRegistries\",\"glacier:GetVaultNotifications\",\"fsx:ListTagsForResource\",\"fsx:DescribeFileSystems\",\"events:CreateEventBus\",\"es:ListTags\",\"es:ListDomainNames\",\"es:DescribeElasticsearchDomains\",\"elasticmapreduce:List*\",\"elasticmapreduce:Describe*\",\"elasticloadbalancing:Describe*\",\"elasticfilesystem:DescribeTags\",\"elasticfilesystem:DescribeFileSystems\",\"elasticfilesystem:DescribeAccessPoints\",\"elasticache:List*\",\"elasticache:Describe*\",\"ecs:List*\",\"ecs:Describe*\",\"ec2:SearchTransitGatewayRoutes\",\"ec2:GetTransitGatewayPrefixListReferences\",\"ec2:GetSnapshotBlockPublicAccessState\",\"ec2:Describe*\",\"dynamodb:List*\",\"dynamodb:Describe*\",\"directconnect:Describe*\",\"cur:DescribeReportDefinitions\",\"codedeploy:List*\",\"codedeploy:BatchGet*\",\"cloudwatch:List*\",\"cloudwatch:Get*\",\"cloudwatch:Describe*\",\"cloudtrail:LookupEvents\",\"cloudtrail:GetTrailStatus\",\"cloudtrail:DescribeTrails\",\"cloudfront:ListDistributions\",\"cloudfront:GetDistributionConfig\",\"cassandra:Select\",\"budgets:ViewBudget\",\"bcm-data-exports:ListExports\",\"bcm-data-exports:GetExport\",\"backup:ListRecoveryPointsByBackupVault\",\"backup:List*\",\"autoscaling:Describe*\",\"apigateway:GET\"],\"Resource\":\"*\"}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["apigateway:GET","autoscaling:Describe*","backup:List*","backup:ListRecoveryPointsByBackupVault","bcm-data-exports:GetExport","bcm-data-exports:ListExports","budgets:ViewBudget","cassandra:Select","cloudfront:GetDistributionConfig","cloudfront:ListDistributions","cloudtrail:DescribeTrails","cloudtrail:GetTrailStatus","cloudtrail:LookupEvents","cloudwatch:Describe*","cloudwatch:Get*","cloudwatch:List*","codedeploy:BatchGet*","codedeploy:List*","cur:DescribeReportDefinitions","directconnect:Describe*","dynamodb:Describe*","dynamodb:List*","ec2:Describe*","ec2:GetSnapshotBlockPublicAccessState","ec2:GetTransitGatewayPrefixListReferences","ec2:SearchTransitGatewayRoutes","ecs:Describe*","ecs:List*","elasticache:Describe*","elasticache:List*","elasticfilesystem:DescribeAccessPoints","elasticfilesystem:DescribeFileSystems","elasticfilesystem:DescribeTags","elasticloadbalancing:Describe*","elasticmapreduce:Describe*","elasticmapreduce:List*","es:DescribeElasticsearchDomains","es:ListDomainNames","es:ListTags","events:CreateEventBus","fsx:DescribeFileSystems","fsx:ListTagsForResource","glacier:GetVaultNotifications","glue:ListRegistries","health:DescribeAffectedEntities","health:DescribeEventDetails","health:DescribeEvents","kinesis:Describe*","kinesis:List*","lambda:GetPolicy","lambda:List*","lightsail:GetInstancePortStates","logs:DeleteSubscriptionFilter","logs:DescribeLogGroups","logs:DescribeLogStreams","logs:DescribeSubscriptionFilters","logs:FilterLogEvents","logs:PutSubscriptionFilter","logs:TestMetricFilter","oam:ListAttachedLinks","oam:ListSinks","organizations:Describe*","organizations:List*","rds:Describe*","rds:List*","redshift:DescribeClusters","redshift:DescribeLoggingStatus","route53:List*","s3:GetBucketLocation","s3:GetBucketLogging","s3:GetBucketNotification","s3:GetBucketTagging","s3:ListAccessGrants","s3:ListAllMyBuckets","s3:PutBucketNotification","savingsplans:DescribeSavingsPlanRates","savingsplans:DescribeSavingsPlans","ses:Get*","sns:GetSubscriptionAttributes","sns:List*","sns:Publish","sqs:ListQueues","states:DescribeStateMachine","states:ListStateMachines","support:DescribeTrustedAdvisor*","support:RefreshTrustedAdvisorCheck","tag:GetResources","tag:GetTagKeys","tag:GetTagValues","timestream:DescribeEndpoints","waf-regional:ListRuleGroups","waf-regional:ListRules","waf:ListRuleGroups","waf:ListRules","wafv2:GetIPSet","wafv2:GetLoggingConfiguration","wafv2:GetRegexPatternSet","wafv2:GetRuleGroup","wafv2:ListLoggingConfigurations","xray:BatchGetTraces","xray:GetTraceSummaries"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["*"],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"mode":"data","type":"aws_iam_policy_document","name":"datadog_aws_integration_assume_role","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"157656493","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::417141415827:root\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"sts:ExternalId\": \"9a68c346a06847c2951facb0e7434b53\"\n        }\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"AWS\":\"arn:aws:iam::417141415827:root\"},\"Condition\":{\"StringEquals\":{\"sts:ExternalId\":\"9a68c346a06847c2951facb0e7434b53\"}}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[{"test":"StringEquals","values":["9a68c346a06847c2951facb0e7434b53"],"variable":"sts:ExternalId"}],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::417141415827:root"],"type":"AWS"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"mode":"data","type":"terraform_remote_state","name":"basesg","provider":"provider[\"terraform.io/builtin/terraform\"]","instances":[{"schema_version":0,"attributes":{"backend":"local","config":{"value":{"path":"/Users/nebakke/tofu/tofu-basesg.tfstate"},"type":["object",{"path":"string"}]},"defaults":null,"outputs":{"value":{"aws_profile":"default","aws_region":"ap-southeast-2","sg-names":["pd-baseline-tf-sg"]},"type":["object",{"aws_profile":"string","aws_region":"string","sg-names":["tuple",["string"]]}]},"workspace":null},"sensitive_attributes":[]}]},{"mode":"managed","type":"aws_iam_policy","name":"datadog_aws_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::724772066194:policy/DatadogAWSIntegrationPolicy","attachment_count":0,"description":"","id":"arn:aws:iam::724772066194:policy/DatadogAWSIntegrationPolicy","name":"DatadogAWSIntegrationPolicy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":[\"xray:GetTraceSummaries\",\"xray:BatchGetTraces\",\"wafv2:ListLoggingConfigurations\",\"wafv2:GetRuleGroup\",\"wafv2:GetRegexPatternSet\",\"wafv2:GetLoggingConfiguration\",\"wafv2:GetIPSet\",\"waf:ListRules\",\"waf:ListRuleGroups\",\"waf-regional:ListRules\",\"waf-regional:ListRuleGroups\",\"timestream:DescribeEndpoints\",\"tag:GetTagValues\",\"tag:GetTagKeys\",\"tag:GetResources\",\"support:RefreshTrustedAdvisorCheck\",\"support:DescribeTrustedAdvisor*\",\"states:ListStateMachines\",\"states:DescribeStateMachine\",\"sqs:ListQueues\",\"sns:Publish\",\"sns:List*\",\"sns:GetSubscriptionAttributes\",\"ses:Get*\",\"savingsplans:DescribeSavingsPlans\",\"savingsplans:DescribeSavingsPlanRates\",\"s3:PutBucketNotification\",\"s3:ListAllMyBuckets\",\"s3:ListAccessGrants\",\"s3:GetBucketTagging\",\"s3:GetBucketNotification\",\"s3:GetBucketLogging\",\"s3:GetBucketLocation\",\"route53:List*\",\"redshift:DescribeLoggingStatus\",\"redshift:DescribeClusters\",\"rds:List*\",\"rds:Describe*\",\"organizations:List*\",\"organizations:Describe*\",\"oam:ListSinks\",\"oam:ListAttachedLinks\",\"logs:TestMetricFilter\",\"logs:PutSubscriptionFilter\",\"logs:FilterLogEvents\",\"logs:DescribeSubscriptionFilters\",\"logs:DescribeLogStreams\",\"logs:DescribeLogGroups\",\"logs:DeleteSubscriptionFilter\",\"lightsail:GetInstancePortStates\",\"lambda:List*\",\"lambda:GetPolicy\",\"kinesis:List*\",\"kinesis:Describe*\",\"health:DescribeEvents\",\"health:DescribeEventDetails\",\"health:DescribeAffectedEntities\",\"glue:ListRegistries\",\"glacier:GetVaultNotifications\",\"fsx:ListTagsForResource\",\"fsx:DescribeFileSystems\",\"events:CreateEventBus\",\"es:ListTags\",\"es:ListDomainNames\",\"es:DescribeElasticsearchDomains\",\"elasticmapreduce:List*\",\"elasticmapreduce:Describe*\",\"elasticloadbalancing:Describe*\",\"elasticfilesystem:DescribeTags\",\"elasticfilesystem:DescribeFileSystems\",\"elasticfilesystem:DescribeAccessPoints\",\"elasticache:List*\",\"elasticache:Describe*\",\"ecs:List*\",\"ecs:Describe*\",\"ec2:SearchTransitGatewayRoutes\",\"ec2:GetTransitGatewayPrefixListReferences\",\"ec2:GetSnapshotBlockPublicAccessState\",\"ec2:Describe*\",\"dynamodb:List*\",\"dynamodb:Describe*\",\"directconnect:Describe*\",\"cur:DescribeReportDefinitions\",\"codedeploy:List*\",\"codedeploy:BatchGet*\",\"cloudwatch:List*\",\"cloudwatch:Get*\",\"cloudwatch:Describe*\",\"cloudtrail:LookupEvents\",\"cloudtrail:GetTrailStatus\",\"cloudtrail:DescribeTrails\",\"cloudfront:ListDistributions\",\"cloudfront:GetDistributionConfig\",\"cassandra:Select\",\"budgets:ViewBudget\",\"bcm-data-exports:ListExports\",\"bcm-data-exports:GetExport\",\"backup:ListRecoveryPointsByBackupVault\",\"backup:List*\",\"autoscaling:Describe*\",\"apigateway:GET\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPA2RP6ICOJIUL57WMWC","tags":null,"tags_all":{}},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["data.aws_iam_policy_document.datadog_aws_integration","data.terraform_remote_state.basesg"]}]},{"mode":"managed","type":"aws_iam_role","name":"datadog_aws_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::724772066194:role/DatadogAWSIntegrationRole","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"StringEquals\":{\"sts:ExternalId\":\"9a68c346a06847c2951facb0e7434b53\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::417141415827:root\"}}],\"Version\":\"2012-10-17\"}","create_date":"2024-11-21T04:09:16Z","description":"Role for Datadog AWS Integration","force_detach_policies":false,"id":"DatadogAWSIntegrationRole","inline_policy":[],"managed_policy_arns":[],"max_session_duration":3600,"name":"DatadogAWSIntegrationRole","name_prefix":"","path":"/","permissions_boundary":"","tags":null,"tags_all":{},"unique_id":"AROA2RP6ICOJLQGPNJMJC"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["data.aws_iam_policy_document.datadog_aws_integration_assume_role","data.terraform_remote_state.basesg","datadog_integration_aws.sandbox"]}]},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"datadog_aws_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"DatadogAWSIntegrationRole-20241121040917321300000001","policy_arn":"arn:aws:iam::724772066194:policy/DatadogAWSIntegrationPolicy","role":"DatadogAWSIntegrationRole"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_policy.datadog_aws_integration","aws_iam_role.datadog_aws_integration","data.aws_iam_policy_document.datadog_aws_integration","data.aws_iam_policy_document.datadog_aws_integration_assume_role","data.terraform_remote_state.basesg","datadog_integration_aws.sandbox"]}]},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"datadog_aws_integration_security_audit","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"DatadogAWSIntegrationRole-20241121040917596800000002","policy_arn":"arn:aws:iam::aws:policy/SecurityAudit","role":"DatadogAWSIntegrationRole"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_role.datadog_aws_integration","data.aws_iam_policy_document.datadog_aws_integration_assume_role","data.terraform_remote_state.basesg","datadog_integration_aws.sandbox"]}]},{"mode":"managed","type":"datadog_integration_aws","name":"sandbox","provider":"provider[\"registry.opentofu.org/datadog/datadog\"]","instances":[{"schema_version":0,"attributes":{"access_key_id":"","account_id":"724772066194","account_specific_namespace_rules":null,"cspm_resource_collection_enabled":"false","excluded_regions":null,"extended_resource_collection_enabled":"false","external_id":"9a68c346a06847c2951facb0e7434b53","filter_tags":null,"host_tags":null,"id":"724772066194:DatadogAWSIntegrationRole","metrics_collection_enabled":"true","resource_collection_enabled":"false","role_name":"DatadogAWSIntegrationRole","secret_access_key":null},"sensitive_attributes":[[{"type":"get_attr","value":"secret_access_key"}]],"private":"bnVsbA=="}]}],"check_results":null}
